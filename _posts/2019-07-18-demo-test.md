---
layout:     post
title:      七月的测试
subtitle:   docker学习
date:       2019-07-18
author:     BY
header-img: img/post-bg-kuaidi.jpg
catalog: true
tags:
    - docker
---

docker配置:/etc/docker/daemon.json
1、阿里巴巴镜像源
2、配置docker 的域名解析
{
  "registry-mirrors": ["https://########.mirror.aliyuncs.com"],
  "insecure-registries":["###########"],
   "dns":["########"]
}



docker基础命令
1、查询镜像：
docker search images
2、下载镜像
docker pull mysql:5.2

3、运行镜像产生容器,并进入容器内
docker run --name mycentos -it 61818b708e23 /bin/bash

4、退出并停止容器
exit
5、退出但不停止容器
ctrl +P+Q

6、拷贝文件到容器
docker cp /home/lgw/simplespringboot.jar 94b564fa9d2d:/root/

7、从容器中拷贝文件出来
docker cp /home/lgw/simplespringboot.jar 94b564fa9d2d:/root/

8、容器生成镜像
docker commit -m "测试容器生成镜像" -a "lgw" 94b564fa9d2d lgw/centos7:1.0

9、备份镜像
docker save 61818b708e23 -o mycentos.tar mycentos:1.0

10、载入镜像
docker load -i mycentos.tar

11、给镜像重新分配名称和版本
docker tag 61818b708e23 mycentos:1.0

12、启动容器添加卷(先是本机文件)
docker run -it -p 12345:8080  -v /root/dockerdata:/data fa43ef971ae8

13、一个完整的启动容器例子
docker run -it -p 12345:8080 --name test1 -v /root/dockerdata/:/data -v /root/newdockerdata/:/newdata fa43ef971ae8


14、构建镜像
docker build -t demo:1.0 .
注意文件名是Dockerfile ，add里面使用相对路径

15、进入镜像
docker attach monitor
 docker exec -it monitor /bin/bash  --推荐这一种，java项目如果是前台启动，前一种进去会卡住

16、查看docker的日志 
docker logs -f -t --tail 100 datacenter

17、docker 私服登陆/登出
docker login -u ###### -p 123456 ##.##.##.##:12124
docker logout

18、上传到私服
docker push ##.##.##.##:12124/bizteam/analysisweb:1.0-SNAPSHOT

19、docker 部署方式启动容器
docker stack deploy -c docker-stack-ccp.yml ccp --resolve-image=never  --with-registry-auth


20、删除tag为none的镜像
docker images|grep none|awk '{print $3}'|xargs docker rmi

docker页面操作portainer.io
http://10.20.4.136:65000/#/stacks
admin/password


http://##.##.##.##:12122/#browse/browse:bizteam:v2%2Fbizteam
